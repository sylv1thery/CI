image: gcc


stages:
 - build
 - test
 - coverage


building_test:
  stage: build
  before_script:
    - apt update && apt -y install cmake libcunit1-dev gcovr
  script:
    - mkdir BuildCI
    - cd BuildCI
    - cmake ..
    - cmake --build . --target test_pract1
  artifacts:
    paths:
    - BuildCI

testing_job:
  stage: test
  before_script:
    - apt update && apt -y install cmake libcunit1-dev gcovr
  script:
    - cd BuildCI
    - ctest -V

computing_coverage:
  stage: coverage
  before_script:
    - apt update && apt -y install cmake libcunit1-dev gcovr
  script:
    - mkdir Coverage
    - cd BuildCI
    - cmake --build . --target cover_html
  artifacts:
    paths:
    - BuildCI/Coverage
